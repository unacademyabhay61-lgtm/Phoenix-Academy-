<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Phoenix Admin Control</title>
    <script src="https://meet.jit.si/external_api.js"></script>
    <style>
        :root { --primary: #3db2ff; --bg: #0b0c0e; --card: #16181c; }
        body { background: var(--bg); color: white; font-family: sans-serif; margin: 0; padding: 15px; }
        .tab-bar { display: flex; gap: 10px; margin-bottom: 20px; }
        .tab { flex: 1; padding: 10px; text-align: center; background: var(--card); border-radius: 10px; cursor: pointer; font-size: 12px; }
        .active-tab { border-bottom: 2px solid var(--primary); color: var(--primary); }
        .card { background: var(--card); padding: 20px; border-radius: 15px; margin-bottom: 20px; border: 1px solid #2a2d32; }
        input, select, textarea { width: 100%; padding: 12px; margin: 8px 0; background: #000; border: 1px solid #333; color: white; border-radius: 10px; box-sizing: border-box; }
        .btn { width: 100%; padding: 12px; background: var(--primary); border: none; color: white; border-radius: 10px; font-weight: bold; cursor: pointer; }
        details { background: #000; padding: 10px; border-radius: 10px; margin-bottom: 10px; border-left: 4px solid orange; }
        summary { cursor: pointer; font-weight: bold; display: flex; justify-content: space-between; }
        .q-row { font-size: 11px; padding: 5px; border-bottom: 1px solid #222; display: flex; justify-content: space-between; }
    </style>
</head>
<body>

    <div class="tab-bar">
        <div class="tab active-tab" onclick="location.reload()">üé• LIVE</div>
        <div class="tab">üìù TESTS</div>
    </div>

    <div class="card">
        <h3>üöÄ Bulk Upload Test</h3>
        <select id="tClass">
            <option value="9th">9th</option><option value="10th">10th</option>
            <option value="11th">11th</option><option value="12th">12th</option>
            <option value="NEET UG">NEET UG</option>
        </select>
        <input type="text" id="tChap" placeholder="Chapter Name">
        <textarea id="tJson" placeholder="Paste JSON here..." rows="4"></textarea>
        <button class="btn" onclick="uploadTest()">UPLOAD TO FOLDER</button>
    </div>

    <div id="folder-container"></div>

    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-firestore.js"></script>

    <script>
        const firebaseConfig = {
            apiKey: "AIzaSyA7MHXGSN-ZIybG8sEZiP9kDAwIHRYCfT8",
            authDomain: "phnoenix-coaching.firebaseapp.com",
            projectId: "phnoenix-coaching"
        };
        firebase.initializeApp(firebaseConfig);
        const db = firebase.firestore();

        async function uploadTest() {
            const raw = document.getElementById('tJson').value;
            const chap = document.getElementById('tChap').value;
            const cls = document.getElementById('tClass').value;
            if(!chap || !raw) return alert("Fill all fields!");
            try {
                const qs = JSON.parse(raw);
                const batch = db.batch();
                qs.forEach(q => {
                    const ref = db.collection("polls").doc();
                    batch.set(ref, { ...q, chapter: chap, targetClass: cls });
                });
                await batch.commit();
                alert("Folder Created!");
                document.getElementById('tJson').value = "";
            } catch(e) { alert("JSON Error!"); }
        }

        db.collection("polls").onSnapshot(snap => {
            let groups = {};
            snap.forEach(doc => {
                const d = doc.data();
                const key = `${d.targetClass || '9th'} | ${d.chapter}`;
                if(!groups[key]) groups[key] = [];
                groups[key].push({id: doc.id, q: d.question});
            });
            let h = "";
            for(let title in groups) {
                h += `<details><summary>üìÅ ${title} <span>${groups[title].length} Qs</span></summary>
                <div style="margin-top:1
                
